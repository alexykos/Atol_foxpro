
*!*	  // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //  
*!*	  // // // ---------- Чек прихода с отправкой электронного чека покупателю ---------- //  
*!*	  // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //  
  driver= CreateObject("AddIn.FprnM45")  
  driver.NewDocument()  
    
*!*	  // Mode - Режим:  
*!*	  *!*	  // 	0 - Выбора  
*!*	  *!*	  // 	1 - Регистрации  
*!*	  *!*	  // 	2 - Отчётов без гашения  
*!*	  *!*	  // 	3 - Отчётов с гашением  
  driver.Mode = 1  
  driver.SetMode()  
    
*!*	  *!*	  // Записать должность и ФИО кассира  
  driver.AttrNumber = 1021  
  driver.AttrValue = "Старший кассир Иванов И.И."  
  driver.WriteAttribute()  
    
  *!*	  // Записать ИНН кассира  
  driver.AttrNumber = 1203  
  driver.AttrValue = "526317984689"  
  driver.WriteAttribute()  
    
  *!*	  // CheckType - Тип чека:  
  *!*	  // 	1 - Приход  
  *!*	  // 	2 - Возврат прихода  
  *!*	  // 	4 - Расход  
  *!*	  // 	5 - Возврат расхода  
  *!*	  // 	7 - Коррекция прихода  
  *!*	  // 	9 - Коррекция расхода  
  driver.CheckType = 1  
  *!*	  // CheckMode - Режим формирования чека:  
  *!*	  // 	0 - только в электронном виде без печати на чековой ленте  
  *!*	  // 	1 - печатать на чековой ленте  
  driver.CheckMode = 1  
  driver.OpenCheck()  
    
  *!*	  // Применяемая система налогооблажения в чеке:  
  *!*	  // 	ОСН - 1  
  *!*	  // 	УСН доход - 2  
  *!*	  // 	УСН доход-расход - 4  
  *!*	  // 	ЕНВД - 8  
  *!*	  // 	ЕСН - 16  
  *!*	  // 	ПСН - 32  
  driver.AttrNumber = 1055  
  driver.AttrValue = 1  
  driver.WriteAttribute()  
    
  *!*	  // Запись контакта покупателя для отправки электронного чека  
  driver.AttrNumber = 1008  
  driver.AttrValue = "+79091235566"  
  driver.WriteAttribute()  
    
  *!*	  // Регистрация товара или услуги  
  driver.BeginItem()  
  driver.Name = "Детсткое питание Тёма"  
  driver.Price = 47.70  
  driver.Quantity = 6  
  *!*	  // Если значение |Summ - Price * Quantity| > 0.01 , то ККТ посчитает, что была скидка и будет при необходимости преобразовывать позицию, разделяя её на 2  
  driver.Summ = 286.20  
  *!*	  // Признак предмета расчёта. Свойство ItemType может принимать значения:  
  *!*	  // 	1 - товар, за исключением подакцизного товара  
  *!*	  // 	2 - подакцизный товар  
  *!*	  // 	3 - работа  
  *!*	  // 	4 - услуга  
  *!*	  // 	5 - приём ставок при деятельность по организации и проведению азартных игр  
  *!*	  // 	6 - выплата выигрышей в азартных играх  
  *!*	  // 	7 - реализация лотерейных билетов или ставок при деятельность по организации и проведению лотерей  
  *!*	  // 	8 - выплата выигрышей в лотереях  
  *!*	  // 	9 -  прав на использование результатов интеллектуальной деятельности или средств индивидуализации  
  *!*	  // 	10 -  аванс, задаток, предоплата, кредит, взносе в счет оплаты, пени, штраф, вознаграждение, бонус и иной аналогичный предмет расчета  
  *!*	  // 	11 -  предмет расчета, состоящий из предметов, каждому из которых может быть присвоено значение от 0 до 10 (набор)  
  *!*	  // 	12 -  предмет расчета, не относящийся к предметам расчета, которым может быть присвоено значение от 0 до 11  
  driver.ItemType = 1  
  *!*	  // Признак способа расчёта. Свойство PaymentMode может принимать значения:  
  *!*	  // 	1 - Полная предварительная оплата до момента передачи предмета расчета  
  *!*	  // 	2 - Частичная предварительная оплата до момента передачи предмета расчета  
  *!*	  // 	3 - Аванс  
  *!*	  // 	4 - Полная оплата, в том числе с учетом аванса (предварительной оплаты) в момент передачи предмета расчета  
  *!*	  // 	5 - Частичная оплата предмета расчета в момент его передачи с последующей оплатой в кредит  
  *!*	  // 	6 - Передача предмета расчета без его оплаты в момент его передачи с последующей оплатой в кредит  
  *!*	  // 	7 - Оплата предмета расчета после его передачи с оплатой в кредит (оплата кредита)  
  driver.PaymentMode = 1  
  driver.Department = 0  
  *!*	  // TaxTypeNumber - Номер налога:  
  *!*	  // 	0 - Налог из секции  
  *!*	  // 	1 - НДС 0%  
  *!*	  // 	2 - НДС 10%  
  *!*	  // 	3 - НДС 18%   
  *!*	  // 	4 - без НДС  
  *!*	  // 	5 - НДС 10/110  
  *!*	  // 	6 - НДС 18/118  
  driver.TaxTypeNumber = 2  
  *!*	  // Способ исчисления суммы налога. Доступные значения TaxMode:  
  *!*	  // 	0 - налог расчитывается от суммы позиции  
  *!*	  // 	1 - налог расчитывается от цены позиции  
  driver.TaxMode = 1  
  *!*	  // Сумма налога TaxSumm. Если передаётся 0, то ККТ считает самостоятельно по TaxTypeNumber и TaxMode
  *!*	  //   . В противном случае в ОФД отправляется переданная сумма, но при значении настройки Т2Р1П114 бит 1 = 1 ККТ  бедет осуществлять контроль переданных данных
  *!*	  // 	, при чём контроль в будущем нельзя будет отключить (Русинова).  
  driver.TaxSumm = (47.70 * 10 / 110 * 100) / 100   
  *!*	  // Скидка больше не изменяет сумму позиции, теперь она просто добавляет информационную печать. Необходимо рассчитывать в кассовом ПО цену со скидкой, а информацию по начисленным скидкам печатать нефискальной печатью и не передавать скидку в ККМ, поэтому код для начисления скидки закомментирован  
  *!*	  // driver.DiscountValue = 10  
  *!*	  // *!*	  // DiscountType - Тип скидки:  
  *!*	  // *!*	  // 	0 - суммовая  
  *!*	  // *!*	  // 	1 - процентная  
  *!*	  // driver.DiscountType = 0  
  driver.EndItem()  
  driver.Caption = "В том числе скидка: 5.30"  
  driver.PrintString()  
  driver.Caption = "Цена без скидки: 53.00"  
  driver.PrintString()  
    
  driver.BeginItem()  
  driver.Name = "Коньяк Победа 0,5"  
  driver.Price = 813.50  
  driver.Quantity = 1  
  *!*	  // Если значение |Summ - Price * Quantity| > 0.01 , то ККТ посчитает, что была скидка и будет при необходимости преобразовывать позицию, разделяя её на 2  
  driver.Summ = 813.50  
  *!*	  // Признак предмета расчёта. Свойство ItemType может принимать значения:  
  *!*	  // 	1 - товар, за исключением подакцизного товара  
  *!*	  // 	2 - подакцизный товар  
  *!*	  // 	3 - работа  
  *!*	  // 	4 - услуга  
  *!*	  // 	5 - приём ставок при деятельность по организации и проведению азартных игр  
  *!*	  // 	6 - выплата выигрышей в азартных играх  
  *!*	  // 	7 - реализация лотерейных билетов или ставок при деятельность по организации и проведению лотерей  
  *!*	  // 	8 - выплата выигрышей в лотереях  
  *!*	  // 	9 -  прав на использование результатов интеллектуальной деятельности или средств индивидуализации  
  *!*	  // 	10 -  аванс, задаток, предоплата, кредит, взносе в счет оплаты, пени, штраф, вознаграждение, бонус и иной аналогичный предмет расчета  
  *!*	  // 	11 -  предмет расчета, состоящий из предметов, каждому из которых может быть присвоено значение от 0 до 10 (набор)  
  *!*	  // 	12 -  предмет расчета, не относящийся к предметам расчета, которым может быть присвоено значение от 0 до 11  
  driver.ItemType = 2  
  *!*	  // Признак способа расчёта. Свойство PaymentMode может принимать значения:  
  *!*	  // 	1 - Полная предварительная оплата до момента передачи предмета расчета  
  *!*	  // 	2 - Частичная предварительная оплата до момента передачи предмета расчета  
  *!*	  // 	3 - Аванс  
  *!*	  // 	4 - Полная оплата, в том числе с учетом аванса (предварительной оплаты) в момент передачи предмета расчета  
  *!*	  // 	5 - Частичная оплата предмета расчета в момент его передачи с последующей оплатой в кредит  
  *!*	  // 	6 - Передача предмета расчета без его оплаты в момент его передачи с последующей оплатой в кредит  
  *!*	  // 	7 - Оплата предмета расчета после его передачи с оплатой в кредит (оплата кредита)  
  driver.PaymentMode = 1  
  driver.Department = 0  
  *!*	  // TaxTypeNumber - Номер налога:  
  *!*	  // 	0 - Налог из секции  
  *!*	  // 	1 - НДС 0%  
  *!*	  // 	2 - НДС 10%  
  *!*	  // 	3 - НДС 18%   
  *!*	  // 	4 - без НДС  
  *!*	  // 	5 - НДС 10/110  
  *!*	  // 	6 - НДС 18/118  
  driver.TaxTypeNumber = 3  
  *!*	  // Способ исчисления суммы налога. Доступные значения TaxMode:  
  *!*	  // 	0 - налог расчитывается от суммы позиции  
  *!*	  // 	1 - налог расчитывается от цены позиции  
  driver.TaxMode = 1  
  *!*	  // Сумма налога TaxSumm. Если передаётся 0, то ККТ считает самостоятельно по TaxTypeNumber и TaxMode. В противном случае в ОФД отправляется переданная сумма, но при значении настройки Т2Р1П114 бит 1 = 1 ККТ  бедет осуществлять контроль переданных данных, при чём контроль в будущем нельзя будет отключить (Русинова).  
  driver.TaxSumm = Math.round(813.50 * 18 / 118 * 100) / 100   
  *!*	  // Скидка больше не изменяет сумму позиции, теперь она просто добавляет информационную печать. Необходимо рассчитывать в кассовом ПО цену со скидкой, а информацию по начисленным скидкам печатать нефискальной печатью и не передавать скидку в ККМ, поэтому код для начисления скидки закомментирован  
  *!*	  // driver.DiscountValue = 10  
  *!*	  // *!*	  // DiscountType - Тип скидки:  
  *!*	  // *!*	  // 	0 - суммовая  
  *!*	  // *!*	  // 	1 - процентная  
  *!*	  // driver.DiscountType = 0  
  driver.EndItem()  
    
  *!*	  // Отброс копеек (округление чека без распределения по позициям). Скидка на чек доступна только для его округления до рубля. Таким образом недоступны: надбавки, назначение "на позицию", процентные значения.  SummCharge(), PercentsCharge(), PercentsDiscount () и ResetChargeDiscount () более недоступны  
  *!*	  // Destination - Назначение скидки:  
  *!*	  // 	0 - на чек  
  *!*	  // 	1 - на позицию (недоступно)  
  driver.Destination = 0  
  driver.Summ = 0.70  
  driver.SummDiscount()  
    
  *!*	  // Нефискальная печать с информацией по скидкам чека  
  driver.Caption = "--Скидки по чеку--"  
  driver.PrintString()  
  driver.Caption = "Сумма чека без скидок 1131.50"  
  driver.PrintString()  
  driver.Caption = "Скидки по карте: 31.80"  
  driver.PrintString()  
  driver.Caption = "Округление: 0.70"  
  driver.PrintString()  
    
  *!*	  // TypeClose - Тип оплаты:  
  *!*	  // 	0 - Наличными  
  *!*	  // 	1 - Электронными средствами платежа  
  driver.TypeClose = 0  
  driver.Summ = 1500.00  
  driver.Payment()  
  driver.CloseCheck()